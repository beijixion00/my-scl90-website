# 云服务器快速部署指南 - 3小时搞定独立网站

## 🎯 快速概览

**目标：** 将SCL-90网站部署到云服务器，月成本约73元
**时间：** 3-4小时
**难度：** 中等（需要基础Linux操作）

## 📋 准备清单

### 开始前需要准备：
- [ ] 阿里云账户（用于购买服务器）
- [ ] GitHub账户（代码托管）
- [ ] 域名（可选，可后续购买）
- [ ] 支付宝（用于支付）
- [ ] 手机（用于实名认证）

## ⚡ 快速部署步骤

### 第一步：购买云服务器（30分钟）

1. **注册阿里云**
   - 访问：https://www.aliyun.com
   - 手机注册，完成实名认证

2. **购买ECS服务器**
   ```
   配置选择：
   - 位置：北京或杭州
   - 规格：1核2G内存
   - 系统：Ubuntu 20.04
   - 存储：40GB SSD
   - 带宽：1Mbps
   - 购买时长：1年（最优惠）
   ```

3. **费用确认**
   - 服务器：68元/月 × 12 = 816元
   - 域名（可选）：60元/年
   - **总计：约876元/年（平均73元/月）**

### 第二步：服务器基础配置（45分钟）

1. **连接服务器**
   ```bash
   # 获取服务器IP地址
   # 使用SSH连接
   ssh root@您的服务器IP
   ```

2. **基础设置**
   ```bash
   # 更新系统
   apt update && apt upgrade -y

   # 安装基础工具
   apt install -y curl wget git vim

   # 创建用户（推荐）
   adduser admin
   usermod -aG sudo admin
   ```

### 第三步：安装环境（60分钟）

1. **安装Node.js**
   ```bash
   # 安装Node.js 18
   curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
   apt-get install -y nodejs

   # 验证安装
   node -v && npm -v

   # 安装PM2（进程管理）
   npm install -g pm2
   ```

2. **安装MongoDB**
   ```bash
   # 安装MongoDB
   wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | apt-key add -
   echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse" | tee /etc/apt/sources.list.d/mongodb-org-6.0.list
   apt-get update
   apt-get install -y mongodb-org

   # 启动MongoDB
   systemctl start mongod
   systemctl enable mongod
   ```

3. **安装Nginx**
   ```bash
   # 安装Nginx
   apt install -y nginx
   systemctl start nginx
   systemctl enable nginx
   ```

### 第四步：部署应用（45分钟）

1. **克隆代码**
   ```bash
   # 切换到admin用户
   su - admin

   # 克隆项目
   git clone https://github.com/您的用户名/my-scl90-website.git
   cd scl90-website

   # 安装依赖
   npm install
   ```

2. **配置环境变量**
   ```bash
   # 创建环境配置
   nano .env.production

   # 添加以下内容
   NODE_ENV=production
   PORT=3000
   MONGODB_URI=mongodb://localhost:27017/scl90
   ADMIN_PASSWORD=1234love
   ```

3. **启动应用**
   ```bash
   # 使用PM2启动
   pm2 start server-final.js --name "scl90-website"
   pm2 save
   pm2 startup
   ```

### 第五步：配置Nginx反向代理（30分钟）

1. **创建配置文件**
   ```bash
   sudo nano /etc/nginx/sites-available/scl90
   ```

2. **添加配置内容**
   ```nginx
   server {
       listen 80;
       server_name 您的域名.com;  # 暂时用IP地址

       location / {
           proxy_pass http://localhost:3000;
           proxy_http_version 1.1;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
       }
   }
   ```

3. **启用配置**
   ```bash
   sudo ln -s /etc/nginx/sites-available/scl90 /etc/nginx/sites-enabled/
   sudo rm /etc/nginx/sites-enabled/default
   sudo nginx -t
   sudo systemctl reload nginx
   ```

### 第六步：SSL证书配置（15分钟）

1. **安装Certbot**
   ```bash
   sudo apt install -y certbot python3-certbot-nginx
   ```

2. **获取SSL证书**
   ```bash
   # 如果有域名，使用域名
   sudo certbot --nginx -d 您的域名.com

   # 如果暂时没有域名，跳过此步
   ```

## 🧪 测试验证

### 基础功能测试
1. **访问网站**
   - 浏览器访问：http://您的服务器IP
   - 应该看到SCL-90主页

2. **检查API**
   - 访问：http://您的服务器IP/api/questions
   - 应该返回JSON格式的题目

3. **测试管理员功能**
   - 访问：http://您的服务器IP/admin
   - 密码：1234love

### 服务状态检查
```bash
# 检查应用状态
pm2 status

# 检查Nginx状态
sudo systemctl status nginx

# 检查MongoDB状态
sudo systemctl status mongod

# 查看应用日志
pm2 logs
```

## 📱 域名配置（可选，后续操作）

### 购买域名
1. **推荐平台**
   - 阿里云万网：wanwang.aliyun.com
   - 腾讯云：dnspod.cloud.tencent.com

2. **DNS配置**
   ```
   类型：A记录
   主机记录：@
   记录值：您的服务器IP
   ```

### 配置HTTPS
```bash
# 获取SSL证书
sudo certbot --nginx -d 您的域名.com -d www.您的域名.com

# 设置自动续期
echo "0 12 * * * /usr/bin/certbot renew --quiet" | crontab -
```

## 🔧 简化运维

### 设置自动备份
```bash
# 创建备份脚本
nano ~/backup.sh

#!/bin/bash
mkdir -p ~/backups
mongodump --host localhost --db scl90 --out ~/backups/$(date +%Y%m%d)
find ~/backups -type d -mtime +7 -exec rm -rf {} \;

# 设置定时备份
chmod +x ~/backup.sh
echo "0 2 * * * ~/backup.sh" | crontab -
```

### 基础监控
```bash
# 安装htop
sudo apt install -y htop

# 监控系统资源
htop

# 监控应用状态
pm2 monit
```

## 💰 费用总结

### 一次性成本
- 服务器（年付）：816元
- 域名（年付）：60元
- **首年总计：876元**

### 月均成本
- **平均：73元/月**
- 相比Vercel Pro版节省：71元/月
- 一年节省：852元

## 🆘 常见问题

### Q: 部署后网站无法访问？
```bash
# 检查防火墙
sudo ufw status

# 检查端口占用
sudo netstat -tlnp | grep :80

# 重启服务
sudo systemctl restart nginx
pm2 restart scl90-website
```

### Q: 数据库连接失败？
```bash
# 检查MongoDB状态
sudo systemctl status mongod

# 手动启动MongoDB
sudo systemctl start mongod

# 测试连接
mongosh --host localhost
```

### Q: 如何更新网站？
```bash
# 拉取最新代码
cd ~/scl90-website
git pull

# 重启应用
pm2 restart scl90-website
```

## 🎯 成功标准

部署成功的标志：
- [ ] 通过IP地址可以访问网站
- [ ] 所有页面正常显示
- [ ] 测评功能正常工作
- [ ] 数据正确保存
- [ ] PM2显示应用运行正常

## 🏆 下一步计划

### 短期优化（1周内）
- [ ] 购买和配置域名
- [ ] 设置SSL证书
- [ ] 配置自动备份
- [ ] 基础监控设置

### 中期扩展（1个月内）
- [ ] 性能优化
- [ ] 安全加固
- [ ] 数据分析
- [ ] 多网站支持

### 长期发展（3个月内）
- [ ] 移动端APP
- [ ] 支付系统集成
- [ ] AI分析功能
- [ ] 企业版开发

---

## 🎉 恭喜！

**如果您按照这个指南操作，3小时后您将拥有：**
✅ 完全独立的云服务器网站
✅ 月成本仅73元的高性价比方案
✅ 完全控制权和数据自主权
✅ 支持无限用户访问
✅ 可扩展到5个测评网站

**立即开始行动，享受独立运营的乐趣！** 🚀

---

**需要帮助？**
- 阿里云技术支持：95187
- MongoDB官方文档：https://docs.mongodb.com
- GitHub Issues：创建问题获取支持